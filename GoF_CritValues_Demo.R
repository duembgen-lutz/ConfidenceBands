source("GoF_CritValues.R")

# Kolmogorov-Smirnov tests ----

n <- 82
kappav <- KS_Critval(n,digits=6,kappa0=0.06)
KS_TestCritval(n=n,kappav=kappav)
KS_CDF(n,kappav)
kappav


# Some results:
#     n | alpha | kappa   
# =========================
#    82 | 0.50  | 0.089434
#       | 0.10  | 0.133046
#       | 0.05  | 0.147790
#       | 0.01  | 0.177323
# -------------------------
#   100 | 0.50  | 0.08115
#       | 0.10  | 0.12067
#       | 0.05  | 0.13403
#       | 0.01  | 0.16081
# ------------------------
#   200 | 0.50  | 0.05771
#       | 0.10  | 0.08569
#       | 0.05  | 0.09516
#       | 0.01  | 0.11416
# ------------------------
#   250 | 0.50  | 0.05169
#       | 0.10  | 0.07673
#       | 0.05  | 0.08520
#       | 0.01  | 0.10221
# -------------------------
#   500 | 0.50  | 0.036682
#       | 0.10  | 0.054394
#       | 0.05  | 0.060393
#       | 0.01  | 0.072431
# -------------------------
#  1000 | 0.50  | 0.02601
#       | 0.10  | 0.03854
#       | 0.05  | 0.04278
#       | 0.01  | 0.05130
# ------------------------
#  2000 | 0.50  | 0.01843
#       | 0.10  | 0.02729
#       | 0.05  | 0.03029
#       | 0.01  | 0.03631
# ------------------------
#  4000 | 0.50  | 0.01305
#       | 0.10  | 0.01931
#       | 0.05  | 0.02144
#       | 0.01  | 0.02570
# ------------------------
#  8000 | 0.50  | 0.00924
#       | 0.10  | 0.01367
#       | 0.05  | 0.01517
#       | 0.01  | 0.01818
# ------------------------


# Stepanova-Pavlenko tests (for confidence bands) ----

n <- 100
gamma <- 1
kappav <- SP_Critval(n,digits=5,gamma=gamma)
SP_TestCritval(n,kappav,gamma=gamma)
SP_CDF(n,kappav,gamma=gamma)
kappav

# Some results:
#     n | gamma  | alpha | kappa   
# =================================
#    82 | 1.0    | 0.50  | 2.88287
#       | 1.0    | 0.10  | 4.28256
#       | 1.0    | 0.05  | 4.76530
#       | 1.0    | 0.01  | 5.78022
# ---------------------------------
#    82 | 1.4579 | 0.50  | 2.45058
#       | 1.4579 | 0.10  | 3.67026
#       | 1.4579 | 0.05  | 4.12372
#       | 1.4579 | 0.01  | 5.19055
# =================================
#   100 | 1.0    | 0.50  | 2.89123
#       | 1.0    | 0.10  | 4.28598
#       | 1.0    | 0.05  | 4.76746
#       | 1.0    | 0.01  | 5.77945
# ---------------------------------
#   100 | 1.4579 | 0.50  | 2.46048
#       | 1.4579 | 0.10  | 3.66838
#       | 1.4579 | 0.05  | 4.11620
#       | 1.4579 | 0.01  | 5.17072
# =================================
#   200 | 1.0    | 0.50  | 2.90970
#       | 1.0    | 0.10  | 4.28470
#       | 1.0    | 0.05  | 4.76148
#       | 1.0    | 0.01  | 5.76137
# ---------------------------------
#   200 | 1.4579 | 0.50  | 2.48488
#       | 1.4579 | 0.10  | 3.65049
#       | 1.4579 | 0.05  | 4.07857
#       | 1.4579 | 0.01  | 5.08465
# =================================
#   250 | 1.0    | 0.50  | 2.91302
#       | 1.0    | 0.10  | 4.28172
#       | 1.0    | 0.05  | 4.75708
#       | 1.0    | 0.01  | 5.75323
# ---------------------------------
#   250 | 1.4579 | 0.50  | 2.49015
#       | 1.4579 | 0.10  | 3.64262
#       | 1.4579 | 0.05  | 4.06479
#       | 1.4579 | 0.01  | 5.05521
# =================================
#   500 | 1.0    | 0.50  | 2.91806
#       | 1.0    | 0.10  | 4.26927
#       | 1.0    | 0.05  | 4.74111
#       | 1.0    | 0.01  | 5.72718
# ---------------------------------
#   500 | 1.4579 | 0.50  | 2.50106
#       | 1.4579 | 0.10  | 3.61613
#       | 1.4579 | 0.05  | 4.02219
#       | 1.4579 | 0.01  | 4.96800
# ---------------------------------
#   500 | 10     | 0.50  | 1.96217
#       | 10     | 0.10  | 2.95403
#       | 10     | 0.05  | 3.38469
#       | 10     | 0.01  | 4.48470
# =================================
#  1000 | 1.0    | 0.50  | 2.91803
#       | 1.0    | 0.10  | 4.25573
#       | 1.0    | 0.05  | 4.72532
#       | 1.0    | 0.01  | 5.70366
# ---------------------------------
#  1000 | 1.4579 | 0.50  | 2.50627
#       | 1.4579 | 0.10  | 3.59003
#       | 1.4579 | 0.05  | 3.98358
#       | 1.4579 | 0.01  | 4.89266
# =================================
#  2000 | 1.0    | 0.50  | 2.91531
#       | 1.0    | 0.10  | 4.24332
#       | 1.0    | 0.05  | 4.71157
#       | 1.0    | 0.01  | 5.68392
# ---------------------------------
#  2000 | 1.4579 | 0.50  | 2.50800
#       | 1.4579 | 0.10  | 3.56647
#       | 1.4579 | 0.05  | 3.95063
#       | 1.4579 | 0.01  | 4.83047
# =================================
#  4000 | 1.0    | 0.50  | 2.91131
#       | 1.0    | 0.10  | 4.23267
#       | 1.0    | 0.05  | 4.70009
#       | 1.0    | 0.01  | 5.66765
# ---------------------------------
#  4000 | 1.4579 | 0.50  | 2.50766
#       | 1.4579 | 0.10  | 3.54600
#       | 1.4579 | 0.05  | 3.92318
#       | 1.4579 | 0.01  | 4.77980
# =================================
#  8000 | 1.0    | 0.50  | 2.90681
#       | 1.0    | 0.10  | 4.22373
#       | 1.0    | 0.05  | 4.69056
#       | 1.0    | 0.01  | 5.65425
# ---------------------------------
#  8000 | 1.4579 | 0.50  | 2.50610
#       | 1.4579 | 0.10  | 3.52854
#       | 1.4579 | 0.05  | 3.90046
#       | 1.4579 | 0.01  | 4.73839
# =================================

# Test the MC quantiles of the asymptotic distribution
# by Orasch-Pouliot (2004):
pv <- c(0.5,0.9,0.95,0.99)
kappav <- c(2.80,4.12,4.57,5.53)
nv <- c(250,500,1000,2000,4000,8000)
Table <- matrix(pv,length(kappav),length(nv)+1)
dimnames(Table)[[1]] <- kappav
dimnames(Table)[[2]] <- c(nv,Inf)
for (j in 1:length(nv)){
	tmp <- SP_CDF(n=nv[j],kappav)
	print(c(nv[j],tmp))
	Table[,j] <- tmp
}
Table
round(Table,4)

# One result:
#      250    500    1000   2000   4000   8000   Inf
# 2.8  0.4473 0.4438 0.4428 0.4433 0.4446 0.4464 0.50
# 4.12 0.8751 0.8770 0.8792 0.8811 0.8829 0.8843 0.90
# 4.57 0.9339 0.9353 0.9367 0.9380 0.9390 0.9399 0.95
# 5.53 0.9855 0.9860 0.9865 0.9869 0.9873 0.9875 0.99

SP_TestCritval(n=500,kappav)



# Berk-Jones tests ----

n <- 100
s <- 0.9
kappav <- BJ_Critval(n,s,digits=3,restr.sup=TRUE,kappa0=2)
BJ_TestCritval(n,s=s,kappav=kappav,restr.sup=TRUE)
# BJ_CDF(n,s,kappav,restr.sup=TRUE)
kappav

# Some results:
# 
# s   |    n | alpha | kappa   
# ==============================
# 0.5 |   82 | 0.50  |  3.17923
#     |      | 0.10  |  6.19988
#     |      | 0.05  |  7.48983
#     |      | 0.01  | 10.52334
# ------------------------------
# 1.0 |   82 | 0.50  |  2.59089
#     |      | 0.10  |  4.56446
#     |      | 0.05  |  5.33160
#     |      | 0.01  |  7.05578
# ------------------------------
# 1.5 |   82 | 0.50  |  2.64923
#     |      | 0.10  |  5.88994
#     |      | 0.05  |  7.99842
#     |      | 0.01  | 17.66770
# ==============================
# 0.5 |  100 | 0.50  |  3.21036
#     |      | 0.10  |  6.22695
#     |      | 0.05  |  7.51728
#     |      | 0.01  | 10.55977
# ------------------------------
# 1.0 |  100 | 0.50  |  2.62870
#     |      | 0.10  |  4.60825
#     |      | 0.05  |  5.37660
#     |      | 0.01  |  7.10283
# ------------------------------
# 1.5 |  100 | 0.50  |  2.69220
#     |      | 0.10  |  5.92137
#     |      | 0.05  |  8.01555
#     |      | 0.01  | 17.66877
# ==============================
# 0.1 |  250 | 0.50  | 12.2705
#     |      | 0.10  | 29.5486
#     |      | 0.05  | 36.5261
#     |      | 0.01  | 52.4592
# -----------------------------
# 0.2 |  250 | 0.50  |  6.2723
#     |      | 0.10  | 14.7879
#     |      | 0.05  | 18.2781
#     |      | 0.01  | 26.2575
# ------------------------------
# 0.5 |  250 | 0.50  |  3.34317
#     |      | 0.10  |  6.32910
#     |      | 0.05  |  7.61203
#     |      | 0.01  | 10.66735
# ------------------------------
# 1.0 |  250 | 0.50  |  2.79032 
#     |      | 0.10  |  4.79255
#     |      | 0.05  |  5.56533
#     |      | 0.01  |  7.29903
# ------------------------------
# 1.5 |  250 | 0.50  |  2.87478 
#     |      | 0.10  |  6.05276
#     |      | 0.05  |  8.08549
#     |      | 0.01  | 17.67152
# ==============================
# 0.5 |  500 | 0.50  |  3.43347
#     |      | 0.10  |  6.39037
#     |      | 0.05  |  7.66250
#     |      | 0.01  | 10.71010
# ------------------------------
# 1.0 |  500 | 0.50  |  2.90020 
#     |      | 0.10  |  4.91540
#     |      | 0.05  |  5.69058
#     |      | 0.01  |  7.42829
# ------------------------------
# 1.5 |  500 | 0.50  |  2.99756 
#     |      | 0.10  |  6.13991
#     |      | 0.05  |  8.13116
#     |      | 0.01  | 17.67257
# ==============================
# 0.5 | 1000 | 0.50  |  3.51655
#     |      | 0.10  |  6.44367
#     |      | 0.05  |  7.70347
#     |      | 0.01  | 10.73688
# ------------------------------
# 1.0 | 1000 | 0.50  |  3.00111 
#     |      | 0.10  |  5.02666
#     |      | 0.05  |  5.80366
#     |      | 0.01  |  7.54436
# ------------------------------
# 1.5 | 1000 | 0.50  |  3.10914 
#     |      | 0.10  |  6.21882
#     |      | 0.05  |  8.17261
#     |      | 0.01  | 17.67310
# ==============================
# 0.5 | 2000 | 0.50  |  3.59346
#     |      | 0.10  |  6.49175
#     |      | 0.05  |  7.73893
#     |      | 0.01  | 10.75535
# ------------------------------
# 1.0 | 2000 | 0.50  |  3.09428 
#     |      | 0.10  |  5.12819
#     |      | 0.05  |  5.90658
#     |      | 0.01  |  7.64952
# ------------------------------
# 1.5 | 2000 | 0.50  |  3.21112 
#     |      | 0.10  |  6.29098
#     |      | 0.05  |  8.21096
#     |      | 0.01  | 17.67349
# ==============================
# 0.5 | 4000 | 0.50  |  3.66505
#     |      | 0.10  |  6.53615
#     |      | 0.05  |  7.77103
#     |      | 0.01  | 10.76949
# ------------------------------
# 1.0 | 4000 | 0.50  |  3.18075
#     |      | 0.10  |  5.22147
#     |      | 0.05  |  6.00092
#     |      | 0.01  |  7.74557
# ------------------------------
# 1.5 | 4000 | 0.50  |  3.30485
#     |      | 0.10  |  6.35751
#     |      | 0.05  |  8.24691
#     |      | 0.01  | 17.67362
# ==============================
# 0.1 | 8000 | 0.50  | 12.2862
#     |      | 0.10  | 29.6928
#     |      | 0.05  | 36.7541
#     |      | 0.01  | 52.9424
# -----------------------------
# 0.5 | 8000 | 0.50  |  3.7320
#     |      | 0.10  |  6.5778
#     |      | 0.05  |  7.8010
#     |      | 0.01  | 10.7814
# ------------------------------
# 1.0 | 8000 | 0.50  |  3.2614
#     |      | 0.10  |  5.3077
#     |      | 0.05  |  6.0880
#     |      | 0.01  |  7.8339
# ------------------------------
# 1.5 | 8000 | 0.50  |  3.3915
#     |      | 0.10  |  6.4193
#     |      | 0.05  |  8.2810
#     |      | 0.01  | 17.6739
# ==============================

# Duembgen-Wellner tests ----

n <- 2000
s <- -0.8
kappav <- DW_Critval(n,s,digits=3,kappa0=15,restr.sup=TRUE)
DW_TestCritval(n,s,kappav=kappav,restr.sup=TRUE)
# DW_CDF(n,s,kappav=kappav,restr.sup=TRUE)
kappav

# Some results:
# 
# s   |    n | alpha | kappa   
# ==============================
# 0.5 |   82 | 0.50  |  2.10136
#     |      | 0.90  |  4.88778
#     |      | 0.95  |  6.12544
#     |      | 0.99  |  9.17199
# ------------------------------
# 1.0 |   82 | 0.50  |  1.78022
#     |      | 0.90  |  3.82475
#     |      | 0.95  |  4.62493
#     |      | 0.99  |  6.41584
# ------------------------------
# 1.5 |   82 | 0.50  |  1.90016
#     |      | 0.90  |  4.73235
#     |      | 0.95  |  6.42292
#     |      | 0.99  | 15.29703
# ==============================
# 0.5 |  100 | 0.50  |  2.08987
#     |      | 0.90  |  4.84326
#     |      | 0.95  |  6.06390
#     |      | 0.99  |  9.08332
# ------------------------------
# 1.0 |  100 | 0.50  |  1.77905
#     |      | 0.90  |  3.82309
#     |      | 0.95  |  4.62316
#     |      | 0.99  |  6.41414
# ------------------------------
# 1.5 |  100 | 0.50  |  1.90095
#     |      | 0.90  |  4.71083
#     |      | 0.95  |  6.37512
#     |      | 0.99  | 15.20095
# ==============================
# 0.1 |  250 | 0.50  |  9.41864
#     |      | 0.90  | 27.09512
#     |      | 0.95  | 34.13975
#     |      | 0.99  | 50.26271
# ------------------------------
# 0.5 |  250 | 0.50  |  2.04583
#     |      | 0.90  |  4.67091
#     |      | 0.95  |  5.82036
#     |      | 0.99  |  8.70123
# ------------------------------
# 1.0 |  250 | 0.50  |  1.77576
#     |      | 0.90  |  3.81686
#     |      | 0.95  |  4.61583
#     |      | 0.99  |  6.40519
# ------------------------------
# 1.5 |  250 | 0.50  |  1.90226
#     |      | 0.90  |  4.62475
#     |      | 0.95  |  6.18853
#     |      | 0.99  | 14.81189
# ==============================
# 0.5 |  500 | 0.50  |  2.02070
#     |      | 0.90  |  4.57139
#     |      | 0.95  |  5.67719
#     |      | 0.99  |  8.45742
# ------------------------------
# 0.6 |  500 | 0.50  |  1.90726
#     |      | 0.90  |  4.18788
#     |      | 0.95  |  5.12003
#     |      | 0.99  |  7.33038
# ------------------------------
# 1.0 |  500 | 0.50  |  1.77541
#     |      | 0.90  |  3.81455
#     |      | 0.95  |  4.61260
#     |      | 0.99  |  6.40020
# ------------------------------
# 1.4 |  500 | 0.50  |  1.86390
#     |      | 0.90  |  4.30266
#     |      | 0.95  |  5.48632
#     |      | 0.99  | 10.30594
# ------------------------------
# 1.5 |  500 | 0.50  |  1.90226
#     |      | 0.90  |  4.57306
#     |      | 0.95  |  6.07882
#     |      | 0.99  | 14.56581
# ==============================
# 0.5 | 1000 | 0.50  |  2.00104
#     |      | 0.90  |  4.49234
#     |      | 0.95  |  5.56261
#     |      | 0.99  |  8.25333
# ------------------------------
# 1.0 | 1000 | 0.50  |  1.77654
#     |      | 0.90  |  3.81427
#     |      | 0.95  |  4.61152
#     |      | 0.99  |  6.39752
# ------------------------------
# 1.5 | 1000 | 0.50  |  1.90229
#     |      | 0.90  |  4.53102
#     |      | 0.95  |  5.99012
#     |      | 0.99  | 14.35134
# ==============================
# 0.5 | 2000 | 0.50  |  1.98567
#     |      | 0.90  |  4.42916
#     |      | 0.95  |  5.47054
#     |      | 0.99  |  8.08369
# ------------------------------
# 1.0 | 2000 | 0.50  |  1.77880
#     |      | 0.90  |  3.81562
#     |      | 0.95  |  4.61223
#     |      | 0.99  |  6.39690
# ------------------------------
# 1.5 | 2000 | 0.50  |  1.90262
#     |      | 0.90  |  4.49681
#     |      | 0.95  |  5.91780
#     |      | 0.99  | 14.16207
# ==============================
# 0.5 | 4000 | 0.50  |  1.97365
#     |      | 0.90  |  4.37821
#     |      | 0.95  |  5.39595
#     |      | 0.99  |  7.94247
# ------------------------------
# 1.0 | 4000 | 0.50  |  1.78185
#     |      | 0.90  |  3.81817
#     |      | 0.95  |  4.61429
#     |      | 0.99  |  6.39790
# ------------------------------
# 1.5 | 4000 | 0.50  |  1.90332
#     |      | 0.90  |  4.46885
#     |      | 0.95  |  5.85819
#     |      | 0.99  | 13.99300
# ==============================
# 1.0 | 8000 | 0.50  |  1.7855
#     |      | 0.90  |  3.8216
#     |      | 0.95  |  4.6173
#     |      | 0.99  |  6.4001
# ==============================
